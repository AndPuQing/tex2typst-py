(()=>{function f(e,t="Assertion failed."){if(!e)throw new Error(t)}var o=class O{type;value;constructor(t,r){this.type=t,this.value=r}eq(t){return this.type===t.type&&this.value===t.value}toString(){switch(this.type){case 4:return"%"+this.value;default:return this.value}}toNode(){return new le(this)}static EMPTY=new O(0,"");static COMMAND_DISPLAYSTYLE=new O(2,"\\displaystyle");static COMMAND_TEXTSTYLE=new O(2,"\\textstyle")},y=class{type;head;constructor(e,t){this.type=e,this.head=t||o.EMPTY}eq(e){return this.type===e.type&&this.head.eq(e.head)}toString(){return this.serialize().reduce(he,"")}},le=class extends y{constructor(e){super("terminal",e)}serialize(){switch(this.head.type){case 0:return[];case 1:case 2:case 3:case 4:case 7:return[this.head];case 5:case 6:{let e=[];for(let t of this.head.value){let r=t===" "?5:6;e.push(new o(r,t))}return e}default:throw new Error(`Unknown terminal token type: ${this.head.type}`)}}},ie=class extends y{constructor(e){f(e.type===3),super("text",e)}serialize(){return[new o(2,"\\text"),new o(1,"{"),this.head,new o(1,"}")]}},E=class extends y{items;constructor(e){super("ordgroup",o.EMPTY),this.items=e}serialize(){return this.items.map(e=>e.serialize()).flat()}},oe=class extends y{base;sup;sub;constructor(e){super("supsub",o.EMPTY),this.base=e.base,this.sup=e.sup,this.sub=e.sub}serialize(){let e=[],{base:t,sup:r,sub:n}=this;e=e.concat(t.serialize());function a(l){return l.type==="ordgroup"||l.type==="supsub"||l.head.type===0?!0:!!(l.head.type===1&&/\d+(\.\d+)?/.test(l.head.value)&&l.head.value.length>1)}return n&&(e.push(new o(7,"_")),a(n)?(e.push(new o(1,"{")),e=e.concat(n.serialize()),e.push(new o(1,"}"))):e=e.concat(n.serialize())),r&&(e.push(new o(7,"^")),a(r)?(e.push(new o(1,"{")),e=e.concat(r.serialize()),e.push(new o(1,"}"))):e=e.concat(r.serialize())),e}},S=class extends y{args;data;constructor(e,t,r=null){super("funcCall",e),this.args=t,this.data=r}serialize(){let e=[];e.push(this.head),this.head.value==="\\sqrt"&&this.data&&(e.push(new o(1,"[")),e=e.concat(this.data.serialize()),e.push(new o(1,"]")));for(let t of this.args)e.push(new o(1,"{")),e=e.concat(t.serialize()),e.push(new o(1,"}"));return e}},ue=class extends y{body;left;right;constructor(e){super("leftright",o.EMPTY),this.body=e.body,this.left=e.left,this.right=e.right}serialize(){let e=[];return e.push(new o(2,"\\left")),e.push(new o(1,this.left?this.left.value:".")),e=e.concat(this.body.serialize()),e.push(new o(2,"\\right")),e.push(new o(1,this.right?this.right.value:".")),e}},ce=class extends y{matrix;data;constructor(e,t,r=null){f(e.type===3),super("beginend",e),this.matrix=t,this.data=r}serialize(){let e=[],t=this.matrix;e.push(new o(2,"\\begin")),e.push(new o(1,"{")),e=e.concat(this.head),e.push(new o(1,"}")),e.push(new o(6,`
`));for(let r=0;r<t.length;r++){let n=t[r];for(let a=0;a<n.length;a++){let l=n[a];e=e.concat(l.serialize()),a!==n.length-1&&e.push(new o(7,"&"))}r!==t.length-1&&e.push(new o(7,"\\\\"))}return e.push(new o(6,`
`)),e.push(new o(2,"\\end")),e.push(new o(1,"{")),e=e.concat(this.head),e.push(new o(1,"}")),e}};function he(e,t){let r=t.toString(),n=!1;return t.type===5?n=!0:(n||=/[{\(\[\|]$/.test(e),n||=/\\\w+$/.test(e)&&r==="[",n||=/^[\.,;:!\?\(\)\]{}_^]$/.test(r),n||=["\\{","\\}"].includes(r),n||=r==="'",n||=e.endsWith("_")||e.endsWith("^"),n||=/\s$/.test(e),n||=/^\s/.test(r),n||=e==="",n||=/[\(\[{]\s*(-|\+)$/.test(e)||e==="-"||e==="+",n||=e.endsWith("&")&&r==="=",n||=/\d$/.test(e)&&/^[a-zA-Z]$/.test(r)),n||(e+=" "),e+r}function pe(e,t){return e.some(r=>r.eq(t))}function j(e,t){let r=[],n=[];for(let a of e)a.eq(t)?(r.push(n),n=[]):n.push(a);return r.push(n),r}function de(e,t){return e.flatMap((r,n)=>n!==e.length-1?[...r,t]:r)}var re={};function we(e,t){let r=e.reMatchArray[0].length,n=t.reMatchArray[0].length;return n!==r?n-r:e.index-t.index}var ge=class{_input;_lexer;_pos=0;_line=0;_col=0;_offset=0;_less=null;_go=!1;_newstate=null;_state;_text=null;_leng=null;_reMatchArray=null;constructor(e,t){this._input=e,this._lexer=t,this._state=t.states[0]}text(){return this._text}leng(){return this._leng}reMatchArray(){return this._reMatchArray}pos(){return this._pos}line(){return this._line}column(){return this._col}input(){return this._input.charAt(this._pos+this._leng+this._offset++)}unput(){return this._offset=this._offset>0?this._offset--:0}less(e){return this._less=e,this._offset=0,this._text=this._text.substring(0,e),this._leng=this._text.length}pushback(e){return this.less(this._leng-e)}reject(){this._go=!0}begin(e){if(this._lexer.specification[e])return this._newstate=e;let t=this._lexer.states[parseInt(e)];if(t)return this._newstate=t;throw"Unknown state '"+e+"' requested"}state(){return this._state}scan(){if(this._pos>=this._input.length)return re;let e=this._input.substring(this._pos),t=this._lexer.specification[this._state],r=[];for(let c=0;c<t.length;c++){let h=t[c],g=e.match(h.re);g!==null&&g[0].length>0&&r.push({index:c,rule:h,reMatchArray:g})}if(r.length===0)throw new Error("No match found for input '"+e+"'");r.sort(we),this._go=!0;let n,a;for(let c=0,h=r.length;c<h&&this._go;c++){this._offset=0,this._less=null,this._go=!1,this._newstate=null;let g=r[c];if(a=g.reMatchArray[0],this._text=a,this._leng=a.length,this._reMatchArray=g.reMatchArray,n=g.rule.action(this),this._newstate&&this._newstate!=this._state){this._state=this._newstate;break}}let l=this._less===null?a:a.substring(0,this._less),i=l.length;this._pos+=i+this._offset;let u=l.match(/\n/g);return u!==null?(this._line+=u.length,this._col=i-l.lastIndexOf(`
`)-1):this._col+=i,n}},fe=class{states;specification;constructor(e){this.states=Object.keys(e),this.specification={};for(let t of this.states){let r=e[t];if(t in this.specification)throw"Duplicate state declaration encountered for state '"+t+"'";this.specification[t]=[];for(let[n,a]of r.entries()){let l;try{l=new RegExp("^"+n)}catch(i){throw"Invalid regexp '"+n+"' in state '"+t+"' ("+i.message+")"}this.specification[t].push({re:l,action:a})}}}scanner(e){return new ge(e,this)}lex(e,t){let r=this.scanner(e);for(;;){let n=r.scan();if(n===re)return;n!==void 0&&t(n)}}collect(e){let t=[],r=function(n){Array.isArray(n)?t.push(...n):t.push(n)};return this.lex(e,r),t}},te=["sqrt","text","bar","bold","boldsymbol","ddot","dot","hat","mathbb","mathbf","mathcal","mathfrak","mathit","mathrm","mathscr","mathsf","mathtt","operatorname","overbrace","overline","pmb","rm","tilde","underbrace","underline","vec","widehat","widetilde","overleftarrow","overrightarrow","hspace","substack","set","displaylines","mathinner","mathrel","mathbin","mathop","not"],ne=["frac","tfrac","binom","dbinom","dfrac","tbinom","overset","underset","textcolor"];function me(e){let t=["{","}","\\","$","&","#","_","%"];for(let r of t)e=e.replaceAll("\\"+r,r);return e}var be=new Map([[String.raw`\\begin{(array|subarry)}{(.+?)}`,e=>{let t=e.reMatchArray();return[new o(2,"\\begin"),new o(7,"{"),new o(3,t[1]),new o(7,"}"),new o(7,"{"),new o(3,t[2]),new o(7,"}")]}],[String.raw`\\(text|operatorname|textcolor|begin|end|hspace|array){(.+?)}`,e=>{let t=e.reMatchArray();return[new o(2,"\\"+t[1]),new o(7,"{"),new o(3,me(t[2])),new o(7,"}")]}],[String.raw`%[^\n]*`,e=>new o(4,e.text().substring(1))],[String.raw`[{}_^&]`,e=>new o(7,e.text())],[String.raw`\\[\\,:;! ]`,e=>new o(7,e.text())],[String.raw`\r?\n`,e=>new o(6,`
`)],[String.raw`\s+`,e=>new o(5,e.text())],[String.raw`\\[{}%$&#_|]`,e=>new o(1,e.text())],[String.raw`(\\[a-zA-Z]+)(\s*\d|\s+[a-zA-Z])\s*([0-9a-zA-Z])`,e=>{let t=e.reMatchArray(),r=t[1];if(ne.includes(r.substring(1))){let n=t[2].trimStart(),a=t[3];return[new o(2,r),new o(1,n),new o(1,a)]}else return e.reject(),[]}],[String.raw`(\\[a-zA-Z]+)(\s*\d|\s+[a-zA-Z])`,e=>{let t=e.reMatchArray(),r=t[1];if(te.includes(r.substring(1))){let n=t[2].trimStart();return[new o(2,r),new o(1,n)]}else return e.reject(),[]}],[String.raw`\\[a-zA-Z]+`,e=>new o(2,e.text())],[String.raw`[0-9]+(\.[0-9]+)?`,e=>new o(1,e.text())],[String.raw`[a-zA-Z]`,e=>new o(1,e.text())],[String.raw`[+\-*/='<>!.,;:?()\[\]|]`,e=>new o(1,e.text())],[String.raw`[^\x00-\x7F]`,e=>new o(1,e.text())],[String.raw`.`,e=>new o(8,e.text())]]),ve={start:be};function ae(e){return new fe(ve).collect(e)}var qe=["bigl","bigr","bigm","biggl","biggr","biggm","Bigl","Bigr","Bigm","Biggl","Biggr","Biggm"],R=o.EMPTY.toNode();function _e(e){return te.includes(e)?1:ne.includes(e)?2:0}var A=new o(7,"{"),T=new o(7,"}"),ye=new o(1,"["),xe=new o(1,"]");function M(e,t){let r=t;for(;r<e.length&&[5,6].includes(e[r].type);)r++;return e.slice(t,r)}function V(e,t){let r=e[t];return r.type===1&&["(",")","[","]","|","\\{","\\}",".","\\|"].includes(r.value)||r.type===2&&["lfloor","rfloor","lceil","rceil","langle","rangle","lparen","rparen","lbrace","rbrace"].includes(r.value.slice(1))?r:null}function k(e,t){let r=t;for(;r<e.length&&e[r].eq(new o(1,"'"));)r+=1;return r-t}var X=new o(2,"\\left"),K=new o(2,"\\right"),Z=new o(2,"\\begin"),Q=new o(2,"\\end"),Ee=new o(7,"\\\\"),p=class v extends Error{constructor(t){super(t),this.name="LatexParserError"}static UNMATCHED_LEFT_BRACE=new v("Unmatched '\\{'");static UNMATCHED_RIGHT_BRACE=new v("Unmatched '\\}'");static UNMATCHED_LEFT_BRACKET=new v("Unmatched '\\['");static UNMATCHED_RIGHT_BRACKET=new v("Unmatched '\\]'");static UNMATCHED_COMMAND_BEGIN=new v("Unmatched '\\begin'");static UNMATCHED_COMMAND_END=new v("Unmatched '\\end'");static UNMATCHED_COMMAND_LEFT=new v("Unmatched '\\left'");static UNMATCHED_COMMAND_RIGHT=new v("Unmatched '\\right'")},U=new o(7,"_"),H=new o(7,"^"),Se=class{space_sensitive;newline_sensitive;alignmentDepth=0;constructor(e=!1,t=!0){this.space_sensitive=e,this.newline_sensitive=t}parse(e){return this.parseGroup(e.slice(0))}parseGroup(e){let[t,r]=this.parseClosure(e,0,null);return t}parseClosure(e,t,r){let n=[],a=t;for(;a<e.length&&!(r!==null&&e[a].eq(r));){let[u,c]=this.parseNextExpr(e,a);a=c,!((u.head.type===5||u.head.type===6)&&(!this.space_sensitive&&u.head.value.replace(/ /g,"").length===0||!this.newline_sensitive&&u.head.value===`
`))&&n.push(u)}if(a>=e.length&&r!==null)return[R,-1];let l=this.applyStyleCommands(n),i;return l.length===1?i=l[0]:i=new E(l),[i,a+1]}parseNextExpr(e,t){let[r,n]=this.parseNextExprWithoutSupSub(e,t),a=null,l=null,i=0;if(i+=k(e,n),n+=i,n<e.length){let u=e[n];if(u.eq(U)){if([a,n]=this.parseNextExprWithoutSupSub(e,n+1),i+=k(e,n),n+=i,n<e.length&&e[n].eq(H)&&([l,n]=this.parseNextExprWithoutSupSub(e,n+1),k(e,n)>0))throw new p("Double superscript")}else if(u.eq(H)){if([l,n]=this.parseNextExprWithoutSupSub(e,n+1),k(e,n)>0)throw new p("Double superscript");if(n<e.length&&e[n].eq(U)&&([a,n]=this.parseNextExprWithoutSupSub(e,n+1),k(e,n)>0))throw new p("Double superscript")}}if(a!==null||l!==null||i>0){let u={base:r,sup:null,sub:null};if(a&&(u.sub=a),i>0){let c=[];for(let h=0;h<i;h++)c.push(new o(1,"'").toNode());l&&c.push(l),u.sup=c.length===1?c[0]:new E(c)}else l&&(u.sup=l);return[new oe(u),n]}else return[r,n]}parseNextExprWithoutSupSub(e,t){if(t>=e.length)throw new p("Unexpected end of input");let r=e[t];switch(r.type){case 1:case 3:case 4:case 5:case 6:return[r.toNode(),t+1];case 2:let n=r.value.slice(1);if(qe.includes(n))return this.parseNextExprWithoutSupSub(e,t+1);if(r.eq(Z))return this.parseBeginEndExpr(e,t);if(r.eq(Q))throw p.UNMATCHED_COMMAND_END;if(r.eq(X))return this.parseLeftRightExpr(e,t);if(r.eq(K))throw p.UNMATCHED_COMMAND_RIGHT;return this.parseCommandExpr(e,t);case 7:switch(r.value){case"{":let[l,i]=this.parseClosure(e,t+1,T);if(i===-1)throw p.UNMATCHED_LEFT_BRACE;return[l,i];case"}":throw p.UNMATCHED_RIGHT_BRACE;case"\\\\":case"\\!":case"\\,":case"\\:":case"\\;":return[r.toNode(),t+1];case"\\ ":return[r.toNode(),t+1];case"_":case"^":return[R,t];case"&":if(this.alignmentDepth<=0)throw new p("Unexpected & outside of an alignment");return[r.toNode(),t+1];default:throw new p("Unknown control sequence")}default:throw new p("Unknown token type")}}parseCommandExpr(e,t){f(e[t].type===2);let r=e[t],n=r.value,a=t+1;switch(_e(n.slice(1))){case 0:return[r.toNode(),a];case 1:{if(a>=e.length)throw new p("Expecting argument for "+n);if(n==="\\sqrt"&&a<e.length&&e[a].eq(ye)){let[c,h]=this.parseClosure(e,a+1,xe);if(h===-1)throw p.UNMATCHED_LEFT_BRACKET;let[g,D]=this.parseNextArg(e,h);return[new S(r,[g],c),D]}else if(n==="\\text"){if(a+2>=e.length)throw new p("Expecting content for \\text command");f(e[a].eq(A)),f(e[a+1].type===3),f(e[a+2].eq(T));let c=e[a+1];return[new ie(c),a+3]}else if(n==="\\displaylines"){f(e[a].eq(A));let[c,h]=this.parseAligned(e,a+1,T);if(h===-1)throw p.UNMATCHED_LEFT_BRACE;let g=new E(de(c,Ee.toNode()));return[new S(r,[g]),h]}let[i,u]=this.parseNextArg(e,a);return[new S(r,[i]),u]}case 2:{let[i,u]=this.parseNextArg(e,a),[c,h]=this.parseNextArg(e,u);return[new S(r,[i,c]),h]}default:throw new Error("Invalid number of parameters")}}parseNextArg(e,t){let r=t,n=null;for(;r<e.length;){let a;if([a,r]=this.parseNextExprWithoutSupSub(e,r),!(a.head.type===5||a.head.type===6)){n=a;break}}if(n===null)throw new p("Expecting argument but token stream ended");return[n,r]}parseLeftRightExpr(e,t){f(e[t].eq(X));let r=t+1;if(r+=M(e,r).length,r>=e.length)throw new p("Expecting a delimiter after \\left");let n=V(e,r);if(n===null)throw new p("Invalid delimiter after \\left");r++;let[a,l]=this.parseClosure(e,r,K);if(l===-1)throw p.UNMATCHED_COMMAND_LEFT;if(r=l,r+=M(e,r).length,r>=e.length)throw new p("Expecting a delimiter after \\right");let i=V(e,r);if(i===null)throw new p("Invalid delimiter after \\right");r++;let u=n.value==="."?null:n,c=i.value==="."?null:i;return[new ue({body:a,left:u,right:c}),r]}parseBeginEndExpr(e,t){f(e[t].eq(Z));let r=t+1;f(e[r].eq(A)),f(e[r+1].type===3),f(e[r+2].eq(T));let n=e[r+1].value;r+=3;let a=null;["array","subarray"].includes(n)&&(r+=M(e,r).length,[a,r]=this.parseNextArg(e,r));let[l,i]=this.parseAligned(e,r,Q);if(i===-1)throw p.UNMATCHED_COMMAND_BEGIN;if(r=i,f(e[r].eq(A)),f(e[r+1].type===3),f(e[r+2].eq(T)),e[r+1].value!==n)throw new p("\\begin and \\end environments mismatch");return r+=3,[new ce(new o(3,n),l,a),r]}parseAligned(e,t,r){this.alignmentDepth++;let n=t;n+=M(e,n).length;let a;if([a,n]=this.parseClosure(e,n,r),n===-1)return[[],-1];let l;if(a.type==="ordgroup"){let i=a.items;for(;i.length>0&&[5,6].includes(i[i.length-1].head.type);)i.pop();l=j(i,new o(7,"\\\\").toNode()).map(u=>j(u,new o(7,"&").toNode()).map(c=>new E(c)))}else l=[[a]];return this.alignmentDepth--,[l,n]}applyStyleCommands(e){for(let t=0;t<e.length;t++){let r=this.getStyleToken(e[t]);if(r){let n=this.applyStyleCommands(e.slice(0,t)),a=this.applyStyleCommands(e.slice(t+1)),l;a.length===0?l=R:a.length===1?l=a[0]:l=new E(a);let i=new S(r,[l]);return n.concat(i)}}return e}getStyleToken(e){return e.type==="terminal"&&(e.head.eq(o.COMMAND_DISPLAYSTYLE)||e.head.eq(o.COMMAND_TEXTSTYLE))?e.head:null}};function Te(e){let t=n=>n.eq(U)||n.eq(H),r=[];for(let n=0;n<e.length;n++)e[n].type===5&&n+1<e.length&&t(e[n+1])||e[n].type===5&&n-1>=0&&t(e[n-1])||r.push(e[n]);return r}function ke(e,t){let r=[];for(let n of e)if(n.type===2&&t[n.value]){let a=ae(t[n.value]);r=r.concat(a)}else r.push(n);return r}function Ne(e,t={}){let r=new Se,n=ae(e);return n=Te(n),n=ke(n,t),r.parse(n)}var I=new Map([["arrow.l.r.double.long","<==>"],["arrow.l.r.long","<-->"],["arrow.r.bar","|->"],["arrow.r.double.bar","|=>"],["arrow.r.double.long","==>"],["arrow.r.long","-->"],["arrow.r.long.squiggly","~~>"],["arrow.r.tail",">->"],["arrow.r.twohead","->>"],["arrow.l.double.long","<=="],["arrow.l.long","<--"],["arrow.l.long.squiggly","<~~"],["arrow.l.tail","<-<"],["arrow.l.twohead","<<-"],["arrow.l.r.double","<=>"],["colon.double.eq","::="],["dots.h","..."],["gt.triple",">>>"],["lt.triple","<<<"],["arrow.r","->"],["arrow.r.double","=>"],["arrow.r.squiggly","~>"],["arrow.l","<-"],["arrow.l.squiggly","<~"],["bar.v.double","||"],["bracket.l.stroked","[|"],["bracket.r.stroked","|]"],["colon.eq",":="],["eq.colon","=:"],["eq.not","!="],["gt.double",">>"],["gt.eq",">="],["lt.double","<<"],["lt.eq","<="],["ast.op","*"],["minus","-"],["tilde.op","~"],["arrow.l.r","<->"]]),F=new Map;for(let[e,t]of I.entries())t.length>1&&F.set(t,e);var s=class w{type;value;constructor(t,r){this.type=t,this.value=r}eq(t){return this.type===t.type&&this.value===t.value}isOneOf(t){return pe(t,this)}toNode(){return new Me(this)}toString(){switch(this.type){case 4:return`"${this.value}"`;case 5:return`//${this.value}`;default:return this.value}}static NONE=new w(0,"#none");static EMPTY=new w(2,"");static LEFT_BRACE=new w(2,"{");static RIGHT_BRACE=new w(2,"}");static LEFT_DELIMITERS=[new w(2,"("),new w(2,"["),new w(2,"{"),new w(2,"|"),new w(1,"chevron.l"),new w(1,"paren.l"),new w(1,"brace.l")];static RIGHT_DELIMITERS=[new w(2,")"),new w(2,"]"),new w(2,"}"),new w(2,"|"),new w(1,"chevron.r"),new w(1,"paren.r"),new w(1,"brace.r")]},Ae=class extends Error{node;constructor(e,t){super(e),this.name="TypstWriterError",this.node=t}},N=new s(7," "),_=class{type;head;options;constructor(e,t){this.type=e,this.head=t||s.NONE}setOptions(e){this.options=e}eq(e){return this.type===e.type&&this.head.eq(e.head)}toString(){throw new Error("Unimplemented toString() in base class TypstNode")}},Me=class extends _{constructor(e){super("terminal",e)}isOverHigh(){return!1}toString(){return this.head.toString()}serialize(e,t){if(this.head.type===2){if(this.head.value===","&&e.insideFunctionDepth>0)return[new s(1,"comma")]}else if(this.head.type===1){let r=this.head.value;return t.preferShorthands&&I.has(r)&&(r=I.get(r)),t.inftyToOo&&r==="infinity"&&(r="oo"),[new s(1,r)]}else if(this.head.type===6||this.head.type===8){let r=[];for(let n of this.head.value)if(n===" ")t.keepSpaces&&r.push(new s(6,n));else if(n===`
`)r.push(new s(1,n));else throw new Ae(`Unexpected whitespace character: ${n}`,this);return r}return[this.head]}},J=class extends _{items;constructor(e){super("group",s.NONE),this.items=e}isOverHigh(){return this.items.some(e=>e.isOverHigh())}serialize(e,t){let r=this.items.flatMap(n=>n.serialize(e,t));return r.length>0&&r[0].eq(N)&&r.shift(),r.length>0&&r[r.length-1].eq(N)&&r.pop(),r}},G=class extends _{base;sup;sub;constructor(e){super("supsub",s.NONE),this.base=e.base,this.sup=e.sup,this.sub=e.sub}isOverHigh(){return this.base.isOverHigh()}serialize(e,t){let r=[],{base:n,sup:a,sub:l}=this;r.push(...n.serialize(e,t));let i=a&&a.head.eq(new s(2,"'"));return i&&r.push(new s(2,"'")),l&&(r.push(new s(2,"_")),r.push(...l.serialize(e,t))),a&&!i&&(r.push(new s(2,"^")),r.push(...a.serialize(e,t))),r.push(N),r}},m=class extends _{args;constructor(e,t){super("funcCall",e),this.args=t}isOverHigh(){return this.head.value==="frac"?!0:this.args.some(e=>e.isOverHigh())}serialize(e,t){let r=[],n=this.head;r.push(n),e.insideFunctionDepth++,r.push(L);for(let a=0;a<this.args.length;a++)r.push(...this.args[a].serialize(e,t)),a<this.args.length-1&&r.push(new s(2,","));if(this.options)for(let[a,l]of Object.entries(this.options))r.push(new s(3,`, ${a}: ${l.toString()}`));return r.push(z),e.insideFunctionDepth--,r}},Oe=class extends _{args;constructor(e){super("fraction",s.NONE),this.args=e}isOverHigh(){return!0}serialize(e,t){let r=[],[n,a]=this.args;return r.push(N),r.push(...n.serialize(e,t)),r.push(new s(2,"/")),r.push(...a.serialize(e,t)),r.push(N),r}},L=new s(2,"("),z=new s(2,")"),$=class extends _{body;left;right;constructor(e,t){super("leftright",e),this.body=t.body,this.left=t.left,this.right=t.right}isOverHigh(){return this.body.isOverHigh()}serialize(e,t){let r=[],n=new s(1,"lr"),{left:a,right:l}=this;return this.head.eq(n)&&(r.push(n),r.push(L)),a&&r.push(a),r.push(...this.body.serialize(e,t)),l&&r.push(l),this.head.eq(n)&&r.push(z),r}},q=class Y extends _{matrix;constructor(t,r){super("matrixLike",t),this.matrix=r}isOverHigh(){return!0}serialize(t,r){let n=[],a,l;if(this.head.eq(Y.MAT)?(a=new s(2,","),l=new s(2,";")):this.head.eq(Y.CASES)?(a=new s(2,"&"),l=new s(2,",")):this.head.eq(s.NONE)&&(a=new s(2,"&"),l=new s(1,"\\")),!this.head.eq(s.NONE)&&(n.push(this.head),t.insideFunctionDepth++,n.push(L),this.options))for(let[i,u]of Object.entries(this.options))n.push(new s(3,`${i}: ${u.toString()}, `));return this.matrix.forEach((i,u)=>{i.forEach((c,h)=>{n.push(...c.serialize(t,r)),h<i.length-1?n.push(a):u<this.matrix.length-1&&n.push(l)})}),this.head.eq(s.NONE)||(n.push(z),t.insideFunctionDepth--),n}static MAT=new s(1,"mat");static CASES=new s(1,"cases")},Ce=class extends _{fragments;constructor(e,t){super("markupFunc",e),this.fragments=t}isOverHigh(){return this.fragments.some(e=>e.isOverHigh())}serialize(e,t){let r=[];if(r.push(this.head),e.insideFunctionDepth++,r.push(L),this.options){let n=Object.entries(this.options);for(let a=0;a<n.length;a++){let[l,i]=n[a];r.push(new s(3,`${l}: ${i.toString()}`)),a<n.length-1&&r.push(new s(2,","))}}r.push(z),r.push(new s(3,"["));for(let n of this.fragments)r.push(new s(3,"$")),r.push(...n.serialize(e,t)),r.push(new s(3,"$"));return r.push(new s(3,"]")),r}},Le=new s(2,"("),ze=new s(2,")"),De=new s(2,","),ee=new s(1,`
`),B=new s(7," "),Re=class{buffer="";queue=[];options;constructor(e){this.options=e}writeBuffer(e,t){let r=t.toString();if(r==="")return;let n=!1;n||=/[\(\[\|]$/.test(this.buffer)&&/^\w/.test(r),n||=/^[})\]\|]$/.test(r),n||=/[^=]$/.test(this.buffer)&&r==="(",n||=/^[_^,;!]$/.test(r),n||=r==="'",n||=/[\(\[{]\s*(-|\+)$/.test(this.buffer)||this.buffer==="-"||this.buffer==="+",n||=r.startsWith(`
`),n||=this.buffer==="",n||=/\s$/.test(this.buffer)||/^\s/.test(r),n||=this.buffer.endsWith("&")&&r==="=",n||=this.buffer.endsWith("/")||r==="/",n||=t.type===3,n||=/[\s_^{\(]$/.test(this.buffer),e!==null&&(n||=e.type===3),n||(this.buffer+=" "),this.buffer+=r}serialize(e){let t={insideFunctionDepth:0};this.queue.push(...e.serialize(t,this.options))}flushQueue(){let e=[];for(let r of this.queue)r.eq(B)&&e.length>0&&e[e.length-1].eq(B)||e.push(r);let t=new s(1,"");for(let r=0;r<e.length;r++)e[r].eq(B)&&(r===0||r===e.length-1||e[r-1].type===6||e[r-1].isOneOf([Le,ee])||e[r+1].isOneOf([ze,De,ee]))&&(e[r]=t);e=e.filter(r=>!r.eq(t));for(let r=0;r<e.length;r++){let n=e[r],a=r===0?null:e[r-1];this.writeBuffer(a,n)}this.queue=[]}finalize(){this.flushQueue();let e=function(n){let a=n.replace(/floor\.l\s*(.*?)\s*floor\.r/g,"floor($1)");return a=a.replace(/floor\(\)/g,'floor("")'),a},t=function(n){let a=n.replace(/ceil\.l\s*(.*?)\s*ceil\.r/g,"ceil($1)");return a=a.replace(/ceil\(\)/g,'ceil("")'),a},r=function(n){let a=n.replace(/floor\.l\s*(.*?)\s*ceil\.r/g,"round($1)");return a=a.replace(/round\(\)/g,'round("")'),a};if(this.options.optimize){let n=[e,t,r];for(let a of n)this.buffer=a(this.buffer)}return this.buffer}},b=new Map([["displaystyle","display"],["textstyle","inline"],["hspace","#h"],["|","bar.v.double"],[",","thin"],[":","med"],[" ","med"],[";","thick"],["blacktriangleleft","triangle.filled.l"],["blacktriangleright","triangle.filled.r"],["clubsuit","suit.club.filled"],["hookleftarrow","arrow.l.hook"],["hookrightarrow","arrow.r.hook"],["leftrightarrow","arrow.l.r"],["lgblksquare","square.filled.big"],["lgwhtsquare","square.stroked.big"],["nearrow","arrow.tr"],["nwarrow","arrow.tl"],["searrow","arrow.br"],["swarrow","arrow.bl"],["spadesuit","suit.spade.filled"],["updownarrow","arrow.t.b"],["ln","ln"],["log","log"],["cos","cos"],["sin","sin"],["tan","tan"],["cot","cot"],["sec","sec"],["csc","csc"],["mod","mod"],["omicron","omicron"],["Xi","Xi"],["Upsilon","Upsilon"],["lim","lim"],["binom","binom"],["tilde","tilde"],["hat","hat"],["sqrt","sqrt"],["nonumber",""],["vec","arrow"],["neq","eq.not"],["dot","dot"],["ddot","dot.double"],["doteq","dot(eq)"],["dots","dots.h"],["vdots","dots.v"],["ddots","dots.down"],["widehat","hat"],["widetilde","tilde"],["quad","quad"],["qquad","wide"],["overbrace","overbrace"],["underbrace","underbrace"],["overline","overline"],["underline","underline"],["bar","macron"],["dbinom","binom"],["tbinom","binom"],["dfrac","frac"],["tfrac","frac"],["operatorname","op"],["boldsymbol","bold"],["mathbb","bb"],["mathbf","bold"],["mathcal","cal"],["mathscr","scr"],["mathit","italic"],["mathfrak","frak"],["mathrm","upright"],["mathsf","sans"],["mathtt","mono"],["rm","upright"],["pmb","bold"],["leadsto","arrow.r.squiggly"],["P","pilcrow"],["S","section"],["aleph","alef"],["infin","infinity"],["Delta","Delta"],["Gamma","Gamma"],["Lambda","Lambda"],["Omega","Omega"],["Phi","Phi"],["Pi","Pi"],["Psi","Psi"],["Sigma","Sigma"],["Theta","Theta"],["alpha","alpha"],["beta","beta"],["bigcirc","circle.big"],["bullet","bullet"],["cdot","dot.op"],["cdots","dots.c"],["checkmark","checkmark"],["chi","chi"],["circ","circle.small"],["colon","colon"],["cong","tilde.equiv"],["coprod","product.co"],["copyright","copyright"],["cup","union"],["curlyvee","or.curly"],["curlywedge","and.curly"],["dagger","dagger"],["dashv","tack.l"],["ddagger","dagger.double"],["delta","delta"],["ddots","dots.down"],["diamond","diamond"],["div","div"],["divideontimes","times.div"],["dotplus","plus.dot"],["ell","ell"],["emptyset","nothing"],["epsilon","epsilon.alt"],["equiv","equiv"],["eta","eta"],["exists","exists"],["forall","forall"],["gamma","gamma"],["ge","gt.eq"],["geq","gt.eq"],["geqslant","gt.eq.slant"],["gg","gt.double"],["hbar","planck"],["imath","dotless.i"],["iiiint","integral.quad"],["iiint","integral.triple"],["iint","integral.double"],["in","in"],["infty","infinity"],["int","integral"],["intercal","top"],["iota","iota"],["jmath","dotless.j"],["kappa","kappa"],["lambda","lambda"],["land","and"],["langle","chevron.l"],["lbrace","brace.l"],["lbrack","bracket.l"],["ldots","dots.h"],["le","lt.eq"],["leftthreetimes","times.three.l"],["leftrightarrow","arrow.l.r"],["leq","lt.eq"],["leqslant","lt.eq.slant"],["lhd","triangle.l"],["ll","lt.double"],["lor","or"],["ltimes","times.l"],["measuredangle","angle.arc"],["mid","divides"],["models","models"],["mp","minus.plus"],["mu","mu"],["nabla","nabla"],["ncong","tilde.equiv.not"],["ne","eq.not"],["neg","not"],["neq","eq.not"],["nexists","exists.not"],["ni","in.rev"],["nleftarrow","arrow.l.not"],["nleq","lt.eq.not"],["nparallel","parallel.not"],["ngeq","gt.eq.not"],["nmid","divides.not"],["notin","in.not"],["nsim","tilde.not"],["nsubseteq","subset.eq.not"],["nu","nu"],["ntriangleleft","lt.tri.not"],["ntriangleright","gt.tri.not"],["odot","dot.circle"],["oint","integral.cont"],["oiint","integral.surf"],["oiiint","integral.vol"],["omega","omega"],["ominus","minus.circle"],["otimes","times.circle"],["parallel","parallel"],["partial","diff"],["perp","perp"],["phi","phi.alt"],["pi","pi"],["pm","plus.minus"],["pounds","pound"],["prec","prec"],["preceq","prec.eq"],["prime","prime"],["prod","product"],["propto","prop"],["psi","psi"],["rangle","chevron.r"],["rbrace","brace.r"],["rbrack","bracket.r"],["rhd","triangle"],["rho","rho"],["rightarrow","arrow.r"],["rightthreetimes","times.three.r"],["rtimes","times.r"],["setminus","without"],["sigma","sigma"],["sim","tilde.op"],["simeq","tilde.eq"],["slash","slash"],["smallsetminus","without"],["spadesuit","suit.spade"],["sqsubseteq","subset.eq.sq"],["sqsupseteq","supset.eq.sq"],["subset","subset"],["subseteq","subset.eq"],["subsetneq","subset.neq"],["succ","succ"],["succeq","succ.eq"],["sum","sum"],["supset","supset"],["supseteq","supset.eq"],["supsetneq","supset.neq"],["tau","tau"],["theta","theta"],["times","times"],["to","arrow.r"],["top","top"],["triangle","triangle.t"],["twoheadrightarrow","arrow.r.twohead"],["upharpoonright","harpoon.tr"],["uplus","union.plus"],["upsilon","upsilon"],["varepsilon","epsilon"],["varnothing","diameter"],["varphi","phi"],["varpi","pi.alt"],["varrho","rho.alt"],["varsigma","sigma.alt"],["vartheta","theta.alt"],["vdash","tack.r"],["vdots","dots.v"],["vee","or"],["wedge","and"],["wr","wreath"],["xi","xi"],["yen","yen"],["zeta","zeta"],["intop","limits(integral)"],["LaTeX","#LaTeX"],["TeX","#TeX"]]),Be=new Map([["acwopencirclearrow","arrow.ccw"],["adots","dots.up"],["angdnr","angle.acute"],["angle","angle"],["angles","angle.s"],["approx","approx"],["approxeq","approx.eq"],["approxident","tilde.triple"],["assert","tack.r.short"],["ast","ast.op"],["astrosun","sun"],["asymp","asymp"],["awint","integral.ccw"],["backcong","tilde.rev.equiv"],["backdprime","prime.double.rev"],["backprime","prime.rev"],["backsim","tilde.rev"],["backsimeq","tilde.eq.rev"],["backslash","backslash"],["backtrprime","prime.triple.rev"],["bardownharpoonleft","harpoon.bl.bar"],["bardownharpoonright","harpoon.br.bar"],["barleftarrow","arrow.l.stop"],["barleftarrowrightarrowbar","arrows.lr.stop"],["barleftharpoondown","harpoon.lb.stop"],["barleftharpoonup","harpoon.lt.stop"],["barrightharpoondown","harpoon.rb.bar"],["barrightharpoonup","harpoon.rt.bar"],["baruparrow","arrow.t.stop"],["barupharpoonleft","harpoon.tl.stop"],["barupharpoonright","harpoon.tr.stop"],["barV","tack.b.double"],["BbbA","AA"],["BbbB","BB"],["BbbC","CC"],["BbbD","DD"],["BbbE","EE"],["BbbF","FF"],["BbbG","GG"],["BbbH","HH"],["BbbI","II"],["BbbJ","JJ"],["BbbK","KK"],["BbbL","LL"],["BbbM","MM"],["BbbN","NN"],["BbbO","OO"],["BbbP","PP"],["BbbQ","QQ"],["BbbR","RR"],["BbbS","SS"],["BbbT","TT"],["BbbU","UU"],["BbbV","VV"],["BbbW","WW"],["BbbX","XX"],["BbbY","YY"],["BbbZ","ZZ"],["because","because"],["bigblacktriangledown","triangle.filled.b"],["bigblacktriangleup","triangle.filled.t"],["bigbot","tack.t.big"],["bigcap","inter.big"],["bigcup","union.big"],["bigcupdot","union.dot.big"],["biginterleave","interleave.big"],["bigodot","dot.o.big"],["bigoplus","plus.o.big"],["bigotimes","times.o.big"],["bigsqcap","inter.sq.big"],["bigsqcup","union.sq.big"],["bigstar","star.filled"],["bigtimes","times.big"],["bigtop","tack.b.big"],["bigtriangledown","triangle.stroked.b"],["bigtriangleup","triangle.stroked.t"],["biguplus","union.plus.big"],["bigvee","or.big"],["bigwedge","and.big"],["bigwhitestar","star.stroked"],["blackhourglass","hourglass.filled"],["blacktriangle","triangle.filled.small.t"],["blacktriangledown","triangle.filled.small.b"],["blkhorzoval","ellipse.filled.h"],["blkvertoval","ellipse.filled.v"],["bot","bot"],["boxast","ast.square"],["boxdot","dot.square"],["boxminus","minus.square"],["boxplus","plus.square"],["boxtimes","times.square"],["cap","inter"],["Cap","inter.double"],["capdot","inter.dot"],["capwedge","inter.and"],["caretinsert","caret"],["cdot","dot.op"],["cdotp","dot.c"],["checkmark","checkmark"],["circledast","ast.op.o"],["circledbullet","bullet.o"],["circledcirc","compose.o"],["circleddash","dash.o"],["circledequal","cc.nd"],["circledparallel","parallel.o"],["circledvert","bar.v.o"],["circledwhitebullet","bullet.stroked.o"],["Colon","colon.double"],["coloneq","colon.eq"],["Coloneq","colon.double.eq"],["complement","complement"],["cong","tilde.equiv"],["coprod","product.co"],["cup","union"],["Cup","union.double"],["cupdot","union.dot"],["cupleftarrow","union.arrow"],["cupvee","union.or"],["curlyeqprec","eq.prec"],["curlyeqsucc","eq.succ"],["curlyvee","or.curly"],["curlywedge","and.curly"],["curvearrowleft","arrow.ccw.half"],["curvearrowright","arrow.cw.half"],["cwopencirclearrow","arrow.cw"],["dagger","dagger"],["dashcolon","dash.colon"],["dashv","tack.l"],["Dashv","tack.l.double"],["dashVdash","tack.l.r"],["ddagger","dagger.double"],["ddddot","dot.quad"],["dddot","dot.triple"],["ddots","dots.down"],["DDownarrow","arrow.b.quad"],["Ddownarrow","arrow.b.triple"],["diameter","diameter"],["diamondcdot","diamond.stroked.dot"],["diamondsuit","suit.diamond.stroked"],["dicei","die.one"],["diceii","die.two"],["diceiii","die.three"],["diceiv","die.four"],["dicev","die.five"],["dicevi","die.six"],["div","div"],["divideontimes","times.div"],["Doteq","eq.dots"],["dotminus","minus.dot"],["dotplus","plus.dot"],["dotsim","tilde.dot"],["dottedcircle","circle.dotted"],["dottedsquare","square.stroked.dotted"],["doubleplus","plus.double"],["downarrow","arrow.b"],["Downarrow","arrow.b.double"],["downarrowbar","arrow.b.stop"],["downarrowbarred","arrow.b.struck"],["downdasharrow","arrow.b.dashed"],["downdownarrows","arrows.bb"],["downharpoonleft","harpoon.bl"],["downharpoonleftbar","harpoon.bl.stop"],["downharpoonright","harpoon.br"],["downharpoonrightbar","harpoon.br.stop"],["downharpoonsleftright","harpoons.blbr"],["downuparrows","arrows.bt"],["downupharpoonsleftright","harpoons.bltr"],["downwhitearrow","arrow.b.stroked"],["downzigzagarrow","arrow.zigzag"],["dprime","prime.double"],["dualmap","multimap.double"],["eighthnote","note.eighth.alt"],["ell","ell"],["emptysetoarr","emptyset.arrow.r"],["emptysetoarrl","emptyset.arrow.l"],["emptysetobar","emptyset.bar"],["emptysetocirc","emptyset.circle"],["eparsl","parallel.slanted.eq"],["eqcolon","eq.colon"],["eqdef","eq.def"],["eqgtr","eq.gt"],["eqless","eq.lt"],["eqsim","minus.tilde"],["equal","eq"],["equalparallel","parallel.eq"],["equiv","eq.triple"],["Equiv","eq.quad"],["equivVert","parallel.equiv"],["eqvparsl","parallel.slanted.equiv"],["errbarblackcircle","errorbar.circle.filled"],["errbarblackdiamond","errorbar.diamond.filled"],["errbarblacksquare","errorbar.square.filled"],["errbarcircle","errorbar.circle.stroked"],["errbardiamond","errorbar.diamond.stroked"],["errbarsquare","errorbar.square.stroked"],["euro","euro"],["exists","exists"],["fallingdotseq","eq.dots.down"],["fint","integral.slash"],["flat","flat"],["forall","forall"],["fourvdots","fence.dotted"],["frown","frown"],["fullouterjoin","join.l.r"],["geq","gt.eq"],["geqq","gt.equiv"],["geqslant","gt.eq.slant"],["gg","gt.double"],["ggg","gt.triple"],["gggnest","gt.triple.nested"],["gnapprox","gt.napprox"],["gneq","gt.neq"],["gneqq","gt.nequiv"],["gnsim","gt.ntilde"],["greater","gt"],["gtlpar","angle.spheric.rev"],["gtrapprox","gt.approx"],["gtrdot","gt.dot"],["gtreqless","gt.eq.lt"],["gtrless","gt.lt"],["gtrsim","gt.tilde"],["heartsuit","suit.heart.stroked"],["hknearrow","arrow.tr.hook"],["hknwarrow","arrow.tl.hook"],["hksearrow","arrow.br.hook"],["hkswarrow","arrow.bl.hook"],["horizbar","bar.h"],["hourglass","hourglass.stroked"],["hrectangle","rect.stroked.h"],["hrectangleblack","rect.filled.h"],["hyphenbullet","bullet.hyph"],["iiiint","integral.quad"],["iiint","integral.triple"],["iinfin","infinity.incomplete"],["iint","integral.double"],["Im","Im"],["imageof","image"],["in","in"],["increment","laplace"],["infty","infinity"],["int","integral"],["intbar","integral.dash"],["intBar","integral.dash.double"],["intcap","integral.inter"],["intclockwise","integral.cw"],["intcup","integral.union"],["interleave","interleave"],["intlarhk","integral.arrow.hook"],["intx","integral.times"],["inversebullet","bullet.hole"],["Join","join"],["langle","chevron.l"],["lAngle","chevron.l.double"],["langledot","chevron.l.dot"],["lat","lat"],["late","lat.eq"],["lbag","bag.l"],["lblkbrbrak","shell.l.filled"],["lbrace","brace.l"],["lBrace","brace.l.stroked"],["lbrack","bracket.l"],["lBrack","bracket.l.stroked"],["lbracklltick","bracket.l.tick.b"],["lbrackultick","bracket.l.tick.t"],["lbrbrak","shell.l"],["Lbrbrak","shell.l.stroked"],["lceil","ceil.l"],["lcurvyangle","chevron.l.curly"],["leftarrow","arrow.l"],["Leftarrow","arrow.l.double"],["leftarrowtail","arrow.l.tail"],["leftarrowtriangle","arrow.l.open"],["leftdasharrow","arrow.l.dashed"],["leftdotarrow","arrow.l.dotted"],["leftdowncurvedarrow","arrow.l.curve"],["leftharpoondown","harpoon.lb"],["leftharpoondownbar","harpoon.lb.bar"],["leftharpoonsupdown","harpoons.ltlb"],["leftharpoonup","harpoon.lt"],["leftharpoonupbar","harpoon.lt.bar"],["leftleftarrows","arrows.ll"],["leftouterjoin","join.l"],["Leftrightarrow","arrow.l.r.double"],["leftrightarrows","arrows.lr"],["leftrightarrowtriangle","arrow.l.r.open"],["leftrightharpoondowndown","harpoon.lb.rb"],["leftrightharpoondownup","harpoon.lb.rt"],["leftrightharpoons","harpoons.ltrb"],["leftrightharpoonsdown","harpoons.lbrb"],["leftrightharpoonsup","harpoons.ltrt"],["leftrightharpoonupdown","harpoon.lt.rb"],["leftrightharpoonupup","harpoon.lt.rt"],["leftrightsquigarrow","arrow.l.r.wave"],["leftsquigarrow","arrow.l.squiggly"],["leftthreearrows","arrows.lll"],["leftthreetimes","times.three.l"],["leftwavearrow","arrow.l.wave"],["leftwhitearrow","arrow.l.stroked"],["leq","lt.eq"],["leqq","lt.equiv"],["leqslant","lt.eq.slant"],["less","lt"],["lessapprox","lt.approx"],["lessdot","lt.dot"],["lesseqgtr","lt.eq.gt"],["lessgtr","lt.gt"],["lesssim","lt.tilde"],["lfloor","floor.l"],["lgblkcircle","circle.filled.big"],["lgroup","paren.l.flat"],["lgwhtcircle","circle.stroked.big"],["ll","lt.double"],["llangle","chevron.l.closed"],["llblacktriangle","triangle.filled.bl"],["llcorner","corner.l.b"],["LLeftarrow","arrow.l.quad"],["Lleftarrow","arrow.l.triple"],["lll","lt.triple"],["lllnest","lt.triple.nested"],["llparenthesis","paren.l.closed"],["lltriangle","triangle.stroked.bl"],["lmoustache","mustache.l"],["lnapprox","lt.napprox"],["lneq","lt.neq"],["lneqq","lt.nequiv"],["lnsim","lt.ntilde"],["longdashv","tack.l.long"],["Longleftarrow","arrow.l.double.long"],["longleftarrow","arrow.l.long"],["Longleftrightarrow","arrow.l.r.double.long"],["longleftrightarrow","arrow.l.r.long"],["longleftsquigarrow","arrow.l.long.squiggly"],["Longmapsfrom","arrow.l.double.long.bar"],["longmapsfrom","arrow.l.long.bar"],["longmapsto","arrow.r.long.bar"],["Longmapsto","arrow.r.double.long.bar"],["Longrightarrow","arrow.r.double.long"],["longrightarrow","arrow.r.long"],["longrightsquigarrow","arrow.r.long.squiggly"],["looparrowleft","arrow.l.loop"],["looparrowright","arrow.r.loop"],["lparen","paren.l"],["lParen","paren.l.stroked"],["lrblacktriangle","triangle.filled.br"],["lrcorner","corner.r.b"],["lrtriangle","triangle.stroked.br"],["ltimes","times.l"],["lvzigzag","fence.l"],["Lvzigzag","fence.l.double"],["maltese","maltese"],["mapsdown","arrow.b.bar"],["mapsfrom","arrow.l.bar"],["Mapsfrom","arrow.l.double.bar"],["mapsto","arrow.r.bar"],["Mapsto","arrow.r.double.bar"],["mapsup","arrow.t.bar"],["mathampersand","amp"],["mathatsign","at"],["mathcolon","colon"],["mathcomma","comma"],["mathdollar","dollar"],["mathexclam","excl"],["mathhyphen","hyph"],["mathparagraph","pilcrow"],["mathpercent","percent"],["mathperiod","dot.basic"],["mathplus","plus"],["mathquestion","quest"],["mathratio","ratio"],["mathsection","section"],["mathsemicolon","semi"],["mathslash","slash"],["mathsterling","pound"],["mathyen","yen"],["mdblkdiamond","diamond.filled.medium"],["mdblklozenge","lozenge.filled.medium"],["mdlgblkcircle","circle.filled"],["mdlgblkdiamond","diamond.filled"],["mdlgblklozenge","lozenge.filled"],["mdlgblksquare","square.filled"],["mdlgwhtcircle","circle.stroked"],["mdlgwhtdiamond","diamond.stroked"],["mdlgwhtlozenge","lozenge.stroked"],["mdlgwhtsquare","square.stroked"],["mdsmblkcircle","circle.filled.tiny"],["mdsmwhtcircle","circle.stroked.small"],["mdwhtdiamond","diamond.stroked.medium"],["mdwhtlozenge","lozenge.stroked.medium"],["measeq","eq.m"],["measuredangle","angle.arc"],["measuredangleleft","angle.arc.rev"],["measuredrightangle","angle.right.arc"],["mho","Omega.inv"],["mid","divides"],["minus","minus"],["models","models"],["mp","minus.plus"],["multimap","multimap"],["nabla","gradient"],["napprox","approx.not"],["nasymp","asymp.not"],["natural","natural"],["ncong","tilde.equiv.not"],["ne","eq.not"],["Nearrow","arrow.tr.double"],["neg","not"],["nequiv","equiv.not"],["neswarrow","arrow.tr.bl"],["nexists","exists.not"],["ngeq","gt.eq.not"],["ngtr","gt.not"],["ngtrless","gt.lt.not"],["ngtrsim","gt.tilde.not"],["nHdownarrow","arrow.b.dstruck"],["nhpar","parallel.struck"],["nHuparrow","arrow.t.dstruck"],["nhVvert","interleave.struck"],["ni","in.rev"],["nLeftarrow","arrow.l.double.not"],["nleftarrow","arrow.l.not"],["nLeftrightarrow","arrow.l.r.double.not"],["nleftrightarrow","arrow.l.r.not"],["nleq","lt.eq.not"],["nless","lt.not"],["nlessgtr","lt.gt.not"],["nlesssim","lt.tilde.not"],["nmid","divides.not"],["nni","in.rev.not"],["notin","in.not"],["nparallel","parallel.not"],["nprec","prec.not"],["npreccurlyeq","prec.curly.eq.not"],["nRightarrow","arrow.r.double.not"],["nrightarrow","arrow.r.not"],["nsim","tilde.not"],["nsimeq","tilde.eq.not"],["nsqsubseteq","subset.eq.sq.not"],["nsqsupseteq","supset.eq.sq.not"],["nsubset","subset.not"],["nsubseteq","subset.eq.not"],["nsucc","succ.not"],["nsucccurlyeq","succ.curly.eq.not"],["nsupset","supset.not"],["nsupseteq","supset.eq.not"],["ntrianglelefteq","lt.tri.eq.not"],["ntrianglerighteq","gt.tri.eq.not"],["nvartriangleleft","lt.tri.not"],["nvartriangleright","gt.tri.not"],["nVdash","forces.not"],["nvdash","tack.r.not"],["nvDash","tack.r.double.not"],["nvinfty","infinity.bar"],["nvLeftarrow","arrow.l.double.struck"],["nvleftarrow","arrow.l.struck"],["nVleftarrow","arrow.l.dstruck"],["nvleftarrowtail","arrow.l.tail.struck"],["nVleftarrowtail","arrow.l.tail.dstruck"],["nvLeftrightarrow","arrow.l.r.double.struck"],["nvleftrightarrow","arrow.l.r.struck"],["nVleftrightarrow","arrow.l.r.dstruck"],["nvRightarrow","arrow.r.double.struck"],["nvrightarrow","arrow.r.struck"],["nVrightarrow","arrow.r.dstruck"],["nvrightarrowtail","arrow.r.tail.struck"],["nVrightarrowtail","arrow.r.tail.dstruck"],["nvtwoheadleftarrow","arrow.l.twohead.struck"],["nVtwoheadleftarrow","arrow.l.twohead.dstruck"],["nvtwoheadleftarrowtail","arrow.l.twohead.tail.struck"],["nVtwoheadleftarrowtail","arrow.l.twohead.tail.dstruck"],["nvtwoheadrightarrow","arrow.r.twohead.struck"],["nVtwoheadrightarrow","arrow.r.twohead.dstruck"],["nvtwoheadrightarrowtail","arrow.r.twohead.tail.struck"],["nVtwoheadrightarrowtail","arrow.r.twohead.tail.dstruck"],["Nwarrow","arrow.tl.double"],["nwsearrow","arrow.tl.br"],["obrbrak","shell.t"],["obslash","backslash.o"],["odiv","div.o"],["odot","dot.o"],["odotslashdot","div.slanted.o"],["ogreaterthan","gt.o"],["oiiint","integral.vol"],["oiint","integral.surf"],["oint","integral.cont"],["ointctrclockwise","integral.cont.ccw"],["olessthan","lt.o"],["ominus","minus.o"],["operp","perp.o"],["oplus","plus.o"],["opluslhrim","plus.o.l"],["oplusrhrim","plus.o.r"],["origof","original"],["oslash","slash.o"],["otimes","times.o"],["otimeshat","times.o.hat"],["otimeslhrim","times.o.l"],["otimesrhrim","times.o.r"],["parallel","parallel"],["parallelogram","parallelogram.stroked"],["parallelogramblack","parallelogram.filled"],["parsim","parallel.tilde"],["partial","partial"],["pentagon","penta.stroked"],["pentagonblack","penta.filled"],["perp","perp"],["pm","plus.minus"],["prec","prec"],["Prec","prec.double"],["precapprox","prec.approx"],["preccurlyeq","prec.curly.eq"],["preceq","prec.eq"],["preceqq","prec.equiv"],["precnapprox","prec.napprox"],["precneq","prec.neq"],["precneqq","prec.nequiv"],["precnsim","prec.ntilde"],["precsim","prec.tilde"],["prime","prime"],["prod","product"],["propto","prop"],["QED","qed"],["qprime","prime.quad"],["quarternote","note.quarter.alt"],["questeq","eq.quest"],["Question","quest.double"],["rangle","chevron.r"],["rAngle","chevron.r.double"],["rangledot","chevron.r.dot"],["rangledownzigzagarrow","angle.azimuth"],["rbag","bag.r"],["rblkbrbrak","shell.r.filled"],["rbrace","brace.r"],["rBrace","brace.r.stroked"],["rbrack","bracket.r"],["rBrack","bracket.r.stroked"],["rbracklrtick","bracket.r.tick.b"],["rbrackurtick","bracket.r.tick.t"],["rbrbrak","shell.r"],["Rbrbrak","shell.r.stroked"],["rceil","ceil.r"],["rcurvyangle","chevron.r.curly"],["Re","Re"],["revangle","angle.rev"],["revemptyset","emptyset.rev"],["revnmid","divides.not.rev"],["rfloor","floor.r"],["rgroup","paren.r.flat"],["rightangle","angle.right"],["rightanglemdot","angle.right.dot"],["rightanglesqr","angle.right.square"],["rightarrow","arrow.r"],["Rightarrow","arrow.r.double"],["rightarrowbar","arrow.r.stop"],["rightarrowonoplus","plus.o.arrow"],["rightarrowtail","arrow.r.tail"],["rightarrowtriangle","arrow.r.open"],["rightdasharrow","arrow.r.dashed"],["rightdotarrow","arrow.r.dotted"],["rightdowncurvedarrow","arrow.r.curve"],["rightharpoondown","harpoon.rb"],["rightharpoondownbar","harpoon.rb.stop"],["rightharpoonsupdown","harpoons.rtrb"],["rightharpoonup","harpoon.rt"],["rightharpoonupbar","harpoon.rt.stop"],["rightleftarrows","arrows.rl"],["rightleftharpoons","harpoons.rtlb"],["rightleftharpoonsdown","harpoons.rblb"],["rightleftharpoonsup","harpoons.rtlt"],["rightouterjoin","join.r"],["rightrightarrows","arrows.rr"],["rightsquigarrow","arrow.r.squiggly"],["rightthreearrows","arrows.rrr"],["rightthreetimes","times.three.r"],["rightwavearrow","arrow.r.wave"],["rightwhitearrow","arrow.r.stroked"],["risingdotseq","eq.dots.up"],["rmoustache","mustache.r"],["rparen","paren.r"],["rParen","paren.r.stroked"],["rrangle","chevron.r.closed"],["RRightarrow","arrow.r.quad"],["Rrightarrow","arrow.r.triple"],["rrparenthesis","paren.r.closed"],["rsolbar","backslash.not"],["rtimes","times.r"],["rvzigzag","fence.r"],["Rvzigzag","fence.r.double"],["Searrow","arrow.br.double"],["setminus","without"],["sharp","sharp"],["shortdowntack","tack.b.short"],["shortlefttack","tack.l.short"],["shortuptack","tack.t.short"],["sim","tilde.op"],["sime","tilde.eq"],["similarleftarrow","arrow.l.tilde"],["similarrightarrow","arrow.r.tilde"],["simneqq","tilde.nequiv"],["smallblacktriangleleft","triangle.filled.small.l"],["smallblacktriangleright","triangle.filled.small.r"],["smallin","in.small"],["smallni","in.rev.small"],["smalltriangleleft","triangle.stroked.small.l"],["smalltriangleright","triangle.stroked.small.r"],["smashtimes","smash"],["smblkcircle","bullet"],["smblkdiamond","diamond.filled.small"],["smblklozenge","lozenge.filled.small"],["smeparsl","parallel.slanted.eq.tilde"],["smile","smile"],["smt","smt"],["smte","smt.eq"],["smwhtcircle","bullet.stroked"],["smwhtdiamond","diamond.stroked.small"],["smwhtlozenge","lozenge.stroked.small"],["sphericalangle","angle.spheric"],["sphericalangleup","angle.spheric.t"],["sqcap","inter.sq"],["Sqcap","inter.sq.double"],["sqcup","union.sq"],["Sqcup","union.sq.double"],["sqint","integral.square"],["sqsubset","subset.sq"],["sqsubseteq","subset.eq.sq"],["sqsubsetneq","subset.sq.neq"],["sqsupset","supset.sq"],["sqsupseteq","supset.eq.sq"],["sqsupsetneq","supset.sq.neq"],["squoval","square.stroked.rounded"],["sslash","slash.double"],["star","star.op"],["stareq","eq.star"],["subset","subset"],["Subset","subset.double"],["subsetdot","subset.dot"],["subseteq","subset.eq"],["subsetneq","subset.neq"],["succ","succ"],["Succ","succ.double"],["succapprox","succ.approx"],["succcurlyeq","succ.curly.eq"],["succeq","succ.eq"],["succeqq","succ.equiv"],["succnapprox","succ.napprox"],["succneq","succ.neq"],["succneqq","succ.nequiv"],["succnsim","succ.ntilde"],["succsim","succ.tilde"],["sum","sum"],["sumint","sum.integral"],["supset","supset"],["Supset","supset.double"],["supsetdot","supset.dot"],["supseteq","supset.eq"],["supsetneq","supset.neq"],["Swarrow","arrow.bl.double"],["therefore","therefore"],["threedangle","angle.spatial"],["threedotcolon","colon.tri.op"],["tieinfty","infinity.tie"],["times","times"],["tminus","miny"],["top","tack.b"],["tplus","tiny"],["trianglecdot","triangle.stroked.dot"],["triangledown","triangle.stroked.small.b"],["triangleleft","triangle.stroked.l"],["trianglelefteq","lt.tri.eq"],["triangleminus","minus.triangle"],["triangleplus","plus.triangle"],["triangleq","eq.delta"],["triangleright","triangle.stroked.r"],["trianglerighteq","gt.tri.eq"],["triangletimes","times.triangle"],["tripleplus","plus.triple"],["trprime","prime.triple"],["trslash","slash.triple"],["turnediota","iota.inv"],["twoheaddownarrow","arrow.b.twohead"],["twoheadleftarrow","arrow.l.twohead"],["twoheadleftarrowtail","arrow.l.twohead.tail"],["twoheadmapsfrom","arrow.l.twohead.bar"],["twoheadmapsto","arrow.r.twohead.bar"],["twoheadrightarrow","arrow.r.twohead"],["twoheadrightarrowtail","arrow.r.twohead.tail"],["twoheaduparrow","arrow.t.twohead"],["twonotes","note.eighth.beamed"],["ubrbrak","shell.b"],["ulblacktriangle","triangle.filled.tl"],["ulcorner","corner.l.t"],["ultriangle","triangle.stroked.tl"],["uminus","union.minus"],["underbrace","brace.b"],["underbracket","bracket.b"],["underparen","paren.b"],["unicodecdots","dots.h.c"],["unicodeellipsis","dots.h"],["upand","amp.inv"],["uparrow","arrow.t"],["Uparrow","arrow.t.double"],["uparrowbarred","arrow.t.struck"],["upbackepsilon","epsilon.alt.rev"],["updasharrow","arrow.t.dashed"],["upDigamma","Digamma"],["updigamma","digamma"],["Updownarrow","arrow.t.b.double"],["updownarrows","arrows.tb"],["updownharpoonleftleft","harpoon.tl.bl"],["updownharpoonleftright","harpoon.tl.br"],["updownharpoonrightleft","harpoon.tr.bl"],["updownharpoonrightright","harpoon.tr.br"],["updownharpoonsleftright","harpoons.tlbr"],["upharpoonleft","harpoon.tl"],["upharpoonleftbar","harpoon.tl.bar"],["upharpoonright","harpoon.tr"],["upharpoonrightbar","harpoon.tr.bar"],["upharpoonsleftright","harpoons.tltr"],["uplus","union.plus"],["upuparrows","arrows.tt"],["upwhitearrow","arrow.t.stroked"],["urblacktriangle","triangle.filled.tr"],["urcorner","corner.r.t"],["urtriangle","triangle.stroked.tr"],["UUparrow","arrow.t.quad"],["Uuparrow","arrow.t.triple"],["varclubsuit","suit.club.stroked"],["varhexagon","hexa.stroked"],["varhexagonblack","hexa.filled"],["varnothing","emptyset"],["varointclockwise","integral.cont.cw"],["varspadesuit","suit.spade.stroked"],["vartriangle","triangle.stroked.small.t"],["vartriangleleft","lt.tri"],["vartriangleright","gt.tri"],["Vbar","tack.t.double"],["Vdash","forces"],["vdash","tack.r"],["vDash","tack.r.double"],["vdots","dots.v"],["vee","or"],["Vee","or.double"],["veedot","or.dot"],["veeeq","eq.equi"],["vert","bar.v"],["Vert","bar.v.double"],["vlongdash","tack.r.long"],["vrectangle","rect.stroked.v"],["vrectangleblack","rect.filled.v"],["Vvert","bar.v.triple"],["vysmblkcircle","circle.filled.small"],["vysmwhtcircle","circle.stroked.tiny"],["wedge","and"],["Wedge","and.double"],["wedgedot","and.dot"],["wedgeq","eq.est"],["whiteinwhitetriangle","triangle.stroked.nested"],["whthorzoval","ellipse.stroked.h"],["whtvertoval","ellipse.stroked.v"],["wideangledown","angle.obtuse"],["wr","wreath"],["xsol","slash.big"]]),Pe=new Map([["gets","leftarrow"],["iff","Longleftrightarrow"],["implies","Longrightarrow"]]);for(let[e,t]of Be)b.has(e)||b.set(e,t);var W=new Map;for(let[e,t]of Array.from(b.entries()).reverse())W.set(t,e);W.set("oo","infty");var Ue=new Map([["top","top"],["frac","frac"],["tilde","tilde"],["hat","hat"],["upright","mathrm"],["bold","boldsymbol"],["infinity","infty"]]);for(let[e,t]of Ue)W.set(e,t);for(let[e,t]of Pe)b.has(e)||b.set(e,b.get(t));var C=class extends Error{node;constructor(e,t=null){super(e),this.name="ConverterError",this.node=t}},He=s.NONE.toNode(),Ie=["dim","id","im","mod","Pr","sech","csch"];function $e(e){if(/^[a-zA-Z0-9]$/.test(e))return e;if(e==="/")return"\\/";if(["\\\\","\\{","\\}","\\%"].includes(e))return e.substring(1);if(["\\$","\\#","\\&","\\_"].includes(e))return e;if(e.startsWith("\\")){let t=e.slice(1);return b.has(t)?b.get(t):null}return e}function x(e,t){let r;switch(e.type){case 0:return s.NONE;case 2:r=1;break;case 1:r=2;break;case 3:r=3;break;case 4:r=5;break;case 5:r=6;break;case 6:r=8;break;case 7:{if(e.value==="\\\\")return new s(7,"\\");if(e.value==="\\!")return new s(1,"#h(-math.thin.amount)");if(b.has(e.value.substring(1))){let a=b.get(e.value.substring(1));return new s(1,a)}else throw new Error(`Unknown control sequence: ${e.value}`)}default:throw Error(`Unknown token type: ${e.type}`)}let n=$e(e.value);if(n===null){if(t.nonStrict)return new s(r,e.value.substring(1));throw new C(`Unknown token: ${e.value}`,e)}return new s(r,n)}function Ye(e,t){let[r,n]=e.args;if(t.optimize&&["\\overset{\\text{def}}{=}","\\overset{d e f}{=}"].includes(e.toString()))return new s(1,"eq.def").toNode();let a=new m(new s(1,"limits"),[d(n,t)]);return new G({base:a,sup:d(r,t),sub:null})}function Fe(e,t){let[r,n]=e.args,a=new m(new s(1,"limits"),[d(n,t)]);return new G({base:a,sub:d(r,t),sup:null})}function Ge(e){let t={},r={l:"#left",c:"#center",r:"#right"},n=Array.from(e),a=[],l=0;for(let u of n)u==="|"?a.push(l):(u==="l"||u==="c"||u==="r")&&l++;if(a.length>0){let u;a.length===1?u=`#${a[0]}`:u=`#(vline: (${a.join(", ")}))`,t.augment=new s(3,u).toNode()}let i=n.map(u=>r[u]).filter(u=>u!==void 0).map(u=>new s(3,u).toNode());if(i.length>0){let u=i.every(c=>c.eq(i[0]));t.align=u?i[0]:new s(3,"#center").toNode()}return t}var We=new s(2,"("),je=new s(2,")");function P(e){return["group","supsub","matrixLike","fraction","empty"].includes(e.type)?new $(null,{left:We,right:je,body:e}):e}function d(e,t){switch(e.type){case"terminal":return x(e.head,t).toNode();case"text":{let n=e;return new s(4,n.head.value).toNode()}case"ordgroup":let r=e;return new J(r.items.map(n=>d(n,t)));case"supsub":{let n=e,{base:a,sup:l,sub:i}=n;if(a&&a.type==="funcCall"&&a.head.value==="\\overbrace"&&l)return new m(new s(1,"overbrace"),[d(a.args[0],t),d(l,t)]);if(a&&a.type==="funcCall"&&a.head.value==="\\underbrace"&&i)return new m(new s(1,"underbrace"),[d(a.args[0],t),d(i,t)]);let u={base:d(a,t),sup:l?d(l,t):null,sub:i?d(i,t):null};return u.sup&&(u.sup=P(u.sup)),u.sub&&(u.sub=P(u.sub)),new G(u)}case"leftright":{let n=e,{left:a,right:l}=n,i=d(n.body,t);if(t.optimize&&a!==null&&l!==null){let g=x(a,t),D=x(l,t);if(a.value==="\\|"&&l.value==="\\|")return new m(new s(1,"norm"),[i]);if(["[]","()","\\{\\}","\\lfloor\\rfloor","\\lceil\\rceil","\\lfloor\\rceil"].includes(a.value+l.value))return new J([g.toNode(),i,D.toNode()])}let u=function(g){return["(",")","{","["].includes(g.value)?new s(2,"\\"+g.value):g},c=a?x(a,t):null,h=l?x(l,t):null;return c===null&&h!==null&&(h=u(h)),h===null&&c!==null&&(c=u(c)),new $(new s(1,"lr"),{body:i,left:c,right:h})}case"funcCall":{let n=e,a=d(n.args[0],t);if(n.head.value==="\\sqrt"&&n.data){let l=d(n.data,t);return new m(new s(1,"root"),[l,a])}if(n.head.value==="\\mathbf"){let l=new m(new s(1,"bold"),[a]);return new m(new s(1,"upright"),[l])}if(n.head.value==="\\overrightarrow")return new m(new s(1,"arrow"),[a]);if(n.head.value==="\\overleftarrow")return new m(new s(1,"accent"),[a,new s(1,"arrow.l").toNode()]);if(n.head.value==="\\operatorname")return t.optimize&&Ie.includes(a.head.value)?new s(1,a.head.value).toNode():new m(new s(1,"op"),[new s(4,a.head.value).toNode()]);if(n.head.value==="\\textcolor"){let l=new Ce(new s(1,"#text"),[d(n.args[1],t)]);return l.setOptions({fill:a}),l}if(n.head.value==="\\substack"||n.head.value==="\\displaylines"||n.head.value==="\\mathinner")return a;if(n.head.value==="\\mathrel")return new m(new s(1,"class"),[new s(4,"relation").toNode(),a]);if(n.head.value==="\\mathbin")return new m(new s(1,"class"),[new s(4,"binary").toNode(),a]);if(n.head.value==="\\mathop")return new m(new s(1,"class"),[new s(4,"large").toNode(),a]);if(n.head.value==="\\set")return new $(null,{body:a,left:s.LEFT_BRACE,right:s.RIGHT_BRACE});if(n.head.value==="\\not"){let l=d(n.args[0],t);if(f(l.type==="terminal"),l.head.type===1)return new s(1,l.head.value+".not").toNode();switch(l.head.value){case"=":return new s(1,"eq.not").toNode();default:throw new Error(`Not supported: \\not ${l.head.value}`)}}if(n.head.value==="\\overset")return Ye(n,t);if(n.head.value==="\\underset")return Fe(n,t);if(n.head.value==="\\frac"&&t.fracToSlash)return new Oe(n.args.map(l=>d(l,t)).map(P));if(t.optimize){if(n.head.value==="\\mathbb"&&/^\\mathbb{[A-Z]}$/.test(n.toString()))return new s(1,a.head.value.repeat(2)).toNode();if(n.head.value==="\\mathrm"&&n.toString()==="\\mathrm{d}")return new s(1,"dif").toNode()}return new m(x(n.head,t),n.args.map(l=>d(l,t)))}case"beginend":{let n=e,a=n.matrix.map(l=>l.map(i=>d(i,t)));if(n.head.value.startsWith("align"))return new q(null,a);if(n.head.value==="cases")return new q(q.CASES,a);if(n.head.value==="subarray"){if(n.data)switch(n.data.head.value){case"r":a.forEach(i=>i.push(s.EMPTY.toNode()));break;case"l":a.forEach(i=>i.unshift(s.EMPTY.toNode()));break;default:break}return new q(null,a)}if(n.head.value==="array"){let l={delim:He};f(n.data!==null&&n.head.type===3);let i=Ge(n.data.head.value);Object.assign(l,i);let u=new q(q.MAT,a);return u.setOptions(l),u}if(n.head.value.endsWith("matrix")){let l=new q(q.MAT,a),i;switch(n.head.value){case"matrix":i=s.NONE;break;case"pmatrix":return l;case"bmatrix":i=new s(4,"[");break;case"Bmatrix":i=new s(4,"{");break;case"vmatrix":i=new s(4,"|");break;case"Vmatrix":{i=new s(1,"bar.v.double");break}default:throw new C(`Unimplemented beginend: ${n.head}`,n)}return l.setOptions({delim:i.toNode()}),l}throw new C(`Unimplemented beginend: ${n.head}`,n)}default:throw new C(`Unimplemented node type: ${e.type}`,e)}}var Ze=new o(1,",").toNode();var Ve=Array.from(F.keys());function Xe(){return`(${Ve.map(t=>(t=t.replaceAll("|","\\|"),t=t.replaceAll(".","\\."),t=t.replaceAll("[","\\["),t=t.replaceAll("]","\\]"),t)).join("|")})`}var Ke=Xe(),Qe=new Map([[String.raw`//[^\n]*`,e=>new s(5,e.text().substring(2))],[String.raw`/`,e=>new s(2,e.text())],[String.raw`[_^&]`,e=>new s(7,e.text())],[String.raw`\r?\n`,e=>new s(8,`
`)],[String.raw`\s+`,e=>new s(6,e.text())],[String.raw`\\[$&#_]`,e=>new s(2,e.text())],[String.raw`\\\n`,e=>[new s(7,"\\"),new s(8,`
`)]],[String.raw`\\\s`,e=>[new s(7,"\\"),new s(6," ")]],[String.raw`\\\S`,e=>new s(7,"")],[String.raw`"([^"]|(\\"))*"`,e=>{let t=e.text().substring(1,e.text().length-1);return t.replaceAll('\\"','"'),new s(4,t)}],[Ke,e=>{let t=e.text(),r=F.get(t);return new s(1,r)}],[String.raw`[0-9]+(\.[0-9]+)?`,e=>new s(2,e.text())],[String.raw`[+\-*/=\'<>!.,;?()\[\]|]`,e=>new s(2,e.text())],[String.raw`#h\((.+?)\)`,e=>{let t=e.reMatchArray();return[new s(1,"#h"),new s(2,"("),new s(3,t[1]),new s(2,")")]}],[String.raw`#none`,e=>new s(0,e.text())],[String.raw`#?[a-zA-Z\.]+`,e=>new s(e.text().length===1?2:1,e.text())],[String.raw`.`,e=>new s(2,e.text())]]);var Je=new s(2,"/").toNode();var er=new s(7,"_"),rr=new s(7,"^"),tr=new s(2,"("),nr=new s(2,")"),ar=new s(2,"["),sr=new s(2,"]"),lr=new s(2,"{"),ir=new s(2,"}"),or=new s(2,","),ur=new s(2,";"),cr=new s(7,"&");function se(e,t={}){let r={nonStrict:!0,preferShorthands:!0,keepSpaces:!1,fracToSlash:!0,inftyToOo:!1,optimize:!0,customTexMacros:{}};if(typeof t!="object")throw new Error("options must be an object");for(let i in r)i in t&&(r[i]=t[i]);let n=Ne(e,r.customTexMacros),a=d(n,r),l=new Re(r);return l.serialize(a),l.finalize()}globalThis.convert=se;})();
